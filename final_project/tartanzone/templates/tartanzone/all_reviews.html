{% extends "tartanzone/nav_base.html"%}

{% block contents%}
{% comment %} <!DOCTYPE html>
{% load staticfiles %}
<html lang="en">
  <head>
    <title>OneSchool &mdash; Website by Colorlib</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">


    <!-- <link href="https://fonts.googleapis.com/css?family=Muli:300,400,700,900" rel="stylesheet"> -->
    <link href="https://fonts.googleapis.com/css?family=Muli:300,400,700,900" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/static/fonts/icomoon/style.css">

    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/jquery-ui.css' %}">
    <link rel="stylesheet" href="{% static 'css/owl.carousel.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/owl.theme.default.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/owl.theme.default.min.css' %}">

    <link rel="stylesheet" href="{% static 'css/jquery.fancybox.min.css' %}">

    <link rel="stylesheet" href="{% static 'css/bootstrap-datepicker.css' %}">



    <!-- <link rel="stylesheet" href="/static/fonts/flaticon/font/flaticon.css' %}"> -->

    <link rel="stylesheet" href="{% static 'css/aos.css' %}">


    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="{% static 'css/review_score.css' %}">

  </head>
  <body data-spy="scroll" data-target=".site-navbar-target" data-offset="300">

  <div class="site-wrap">

    <div class="site-mobile-menu site-navbar-target">
      <div class="site-mobile-menu-header">
        <div class="site-mobile-menu-close mt-3">
          <span class="icon-close2 js-menu-toggle"></span>
        </div>
      </div>
      <div class="site-mobile-menu-body"></div>
    </div>


    <header class="site-navbar py-4 js-sticky-header site-navbar-target" role="banner">

      <div class="container-fluid">
        <div class="d-flex align-items-center">
          <div class="site-logo mr-auto w-25"><a href="{{ home }}">Boom School</a></div>

          <div class="mx-auto text-center">
            <nav class="site-navigation position-relative text-right" role="navigation">
              <ul class="site-menu main-menu js-clone-nav mx-auto d-none d-lg-block  m-0 p-0">
                {% if student %}
                <li><a href="{% url 'my_course' %}" class="nav-link">My course</a></li>
                {% endif %}
                <li><a href="{% url 'my_group' %}" class="nav-link">My group</a></li>
                <li><a href="{% url 'all_courses' %}" class="nav-link">All courses</a></li>
                <li><a href="{% url 'all_instructor' %}" class="nav-link">All instructor</a></li>
              </ul>
            </nav>
          </div>

          <div class="ml-auto w-25">
            <nav class="site-navigation position-relative text-right" role="navigation">
              <ul class="site-menu main-menu site-menu-dark js-clone-nav mr-auto d-none d-lg-block m-0 p-0">
                <li class="cta"><a href="{% url 'logout' %}" class="nav-link"><span>Log out</span></a></li>
               {{request.user.username}}
              </ul>
            </nav>
            <a href="#" class="d-inline-block d-lg-none site-menu-toggle js-menu-toggle text-black float-right"><span class="icon-menu h3"></span></a>
          </div>
        </div>
      </div>

    </header> {% endcomment %}

    <div class="intro-section single-cover" id="home-section">

      <div class="slide-1 " style="background-image: url('/static/images/img_2.jpg');" data-stellar-background-ratio="0.5">
        <div class="container">
          <div class="row align-items-center">
            <div class="col-12">
              <div class="row justify-content-center align-items-center text-center">
                <div class="col-lg-6">
                  <br>
                  <h1 data-aos="fade-up" data-aos-delay="0">{{course.code}}: {{course.name}}</h1>
                  <p data-aos="fade-up" data-aos-delay="100">Semester: {{course.semester}} &bullet; Quota: {{course.quota}} &bullet;</p>
                </div>


              </div>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="site-section">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 mb-5">



            <div class="pt-5">
              <h3 class="mb-5">Course Review</h3>
              <div align="right">
                <form action="{% url 'all_reviews' course.id %}" method="post">
                  {% csrf_token %}
                  Order by:
                  <button name="agree" class="btn btn-default">agree&darr;</button>
                  <button name="time" class="btn btn-default">time&darr;</button>
                </form>
              </div>
              <ul class="comment-list">
                {% for r in review %}
                <li class="comment">
                  <div class="vcard bio">
                    <img src="/static/images/person_1.jpg" alt="Image placeholder">
                  </div>
                  <div class="comment-body">
                    <h3>{{r.student}}</h3>
                    <div class="meta">{{r.time}}</div>
                    <div class="score" align="right">Score:
                    {% if r.five_star %}
                    <span class="fa fa-star checked"></span>
                    <span class="fa fa-star checked"></span>
                    <span class="fa fa-star checked"></span>
                    <span class="fa fa-star checked"></span>
                    <span class="fa fa-star checked"></span>
                    {% endif %}
                    {% if r.four_star %}
                    <span class="fa fa-star checked"></span>
                    <span class="fa fa-star checked"></span>
                    <span class="fa fa-star checked"></span>
                    <span class="fa fa-star checked"></span>
                    <span class="fa fa-star"></span>
                    {% endif %}
                    {% if r.three_star %}
                    <span class="fa fa-star checked"></span>
                    <span class="fa fa-star checked"></span>
                    <span class="fa fa-star checked"></span>
                    <span class="fa fa-star"></span>
                    <span class="fa fa-star"></span>
                    {% endif %}
                    {% if r.two_star %}
                    <span class="fa fa-star checked"></span>
                    <span class="fa fa-star checked"></span>
                    <span class="fa fa-star"></span>
                    <span class="fa fa-star"></span>
                    <span class="fa fa-star"></span>
                    {% endif %}
                    {% if r.one_star %}
                    <span class="fa fa-star checked"></span>
                    <span class="fa fa-star"></span>
                    <span class="fa fa-star"></span>
                    <span class="fa fa-star"></span>
                    <span class="fa fa-star"></span>
                    {% endif %}
                  </div>
                    <p>{{r.content}}</p>
                    <p><button class="reply agree btn" value="{{r.id}}">agree</button>    <button class="reply disagree btn" value="{{r.id}}">disagree</button>   <span id="{{r.id}}">    {{r.agree}} </span></p>
                  </div>
                </li>
                {% if admin %}
                <p class="mt-4"><a href="{% url 'delete_review' r.id course.id %}" class="btn btn-primary">Delete review</a></p>
                {% endif %}
                {% endfor %}
              </ul>
              <!-- END comment-list -->


              </div>
            </div>
          </div>
          </div>


        </div>
      </div>




      {% comment %} <footer class="footer-section bg-light">
        <div class="container">
          <div class="row">
            <div class="col-md-4">
              <h3>About OneSchool</h3>
              <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Porro consectetur ut hic ipsum et veritatis corrupti. Itaque eius soluta optio dolorum temporibus in, atque, quos fugit sunt sit quaerat dicta.</p>
            </div>

            <div class="col-md-3 ml-auto">
              <h3>Links</h3>
              <ul class="list-unstyled footer-links">
                <li><a href="{% url 'home' %}">Home</a></li>
                <li><a href="{% url 'all_courses'%}">Courses</a></li>
                <li><a href="{% url 'all_instructor'%}">Teachers</a></li>
              </ul>
            </div>


          </div>

          <div class="row pt-5 mt-5 text-center">
            <div class="col-md-12">
              <div class="border-top pt-5">
              <p>
          <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
          Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="icon-heart" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank" >Colorlib</a>
          <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
        </p>
              </div>
            </div>

          </div>
        </div>
      </footer> {% endcomment %}


  {% comment %} <script src="/static/js/jquery-3.3.1.min.js"></script>
  <script src="/static/js/jquery-migrate-3.0.1.min.js"></script>
  <script src="/static/js/jquery-ui.js"></script>
  <script src="/static/js/popper.min.js"></script>
  <script src="/static/js/bootstrap.min.js"></script>
  <script src="/static/js/owl.carousel.min.js"></script>
  <script src="/static/js/jquery.stellar.min.js"></script>
  <script src="/static/js/jquery.countdown.min.js"></script>
  <script src="/static/js/bootstrap-datepicker.min.js"></script>
  <script src="/static/js/jquery.easing.1.3.js"></script>
  <script src="/static/js/aos.js"></script>
  <script src="/static/js/jquery.fancybox.min.js"></script>
  <script src="/static/js/jquery.sticky.js"></script>
  <script src="/static/js/main.js"></script>
  <script src="js/main.js"></script> {% endcomment %}

  <script type="text/javascript">
    var agreeBtn = document.getElementsByClassName("agree");
    console.log(agreeBtn);
    for (var i = 0; i < agreeBtn.length; i++) {
      agreeBtn[i].addEventListener('click', function(e) {
        var btn = e.target;
        $.ajax({
          type:"POST",
          url:'{% url 'ajax_agree' %}',
          data: {
            review_id: btn.value,
            csrfmiddlewaretoken:$('input[name=csrfmiddlewaretoken]').val()
          },
          success:function(result) {
            success = result['success'];
            if (success == "no") {
              alert("You have already agreed with this review.");
            }
            agree_num = result['agree_num'];
            var span = document.getElementById(btn.value);
            span.innerHTML = agree_num;
          }
        });
      });
    }



    var disagreeBtn = document.getElementsByClassName("disagree");
    console.log(disagreeBtn);
    for (var i = 0; i < disagreeBtn.length; i++) {
      disagreeBtn[i].addEventListener('click', function(e) {
        var btn = e.target;
        $.ajax({
          type:"POST",
          url:'{% url 'ajax_disagree' %}',
          data: {
            review_id: btn.value,
            csrfmiddlewaretoken:$('input[name=csrfmiddlewaretoken]').val()
          },
          success:function(result) {
            success = result['success'];
            if (success == "no") {
              alert("You haven't agreed with this review, cannot disagree.");
            } else if (success == "mistake") {
              alert("The agree num of this review is 0!");
            }
            agree_num = result['agree_num'];
            var span = document.getElementById(btn.value);
            span.innerHTML = agree_num;
          }
        });
      });
    }

  </script>
 {% endblock %}

  {% comment %} </body>
</html> {% endcomment %}
